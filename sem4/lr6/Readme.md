# Лабораторная работа №6: Работа с SQLite. Классы
> Автор: *Иванов Никита Русланович*

### Цель работы:
Изучение работы с базами данных SQLite с использованием объектно-ориентированного программирования (ООП). Реализация паттерна Singleton, параметризованных запросов и фиксации значений атрибутов с помощью свойств (property).

---

## Описание решения:

#### 1. Создан класс `Database` для работы с SQLite:
- Реализован паттерн **Singleton** через декоратор `@singleton`.
- Методы работы с БД:
  - `create_table`: создание таблицы.
  - `insert`: добавление одной записи.
  - `insert_many_users`: добавление нескольких записей через параметризованный запрос.
  - `read`: чтение данных из таблицы.
  - `update`: обновление данных по условию.
  - `delete`: удаление записей по условию.
  - `close`: закрытие соединения.

#### 2. Реализован класс `User`:
- Класс описывает объект пользователя с атрибутами:
  - `id`: идентификатор пользователя.
  - `height`: рост пользователя.
  - `name`: имя пользователя.
  - `deleted`: флаг удаления.
  - `created`: дата создания.
- С помощью свойств (`@property`) реализованы проверки на корректность значений:
  - `id` — должно быть положительным целым числом.
  - `height` — должно быть положительным числом.
  - `name` — не должно быть пустым или начинаться с цифры.
  - `deleted` — должно быть логическим значением.
- Метод `tuple` позволяет конвертировать объект в кортеж для последующего внесения в базу данных.

#### 3. Сценарий выполнения программы:
- Подключение к БД в памяти (`:memory:`).
- Создание таблицы `user` с колонками:
  ```sql
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  name TEXT,
  height NUMBER,
  created TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  deleted BOOL DEFAULT 'FALSE'
  ```
- Создание списка пользователей через класс `User` и конвертация их в кортежи.
- Добавление пользователей в таблицу с помощью метода `insert_many_users`.
- Вывод содержимого таблицы `user` (метод `read`).
- Удаление пользователя с именем "Кирилл" (метод `delete`).
- Изменение роста пользователя "Олег" на 1.82 (метод `update`).
- Повторный вывод содержимого таблицы.

#### 4. Пример использования параметризованных запросов:
- Вставка нескольких записей:
  ```python
  query = f"INSERT INTO {table} (id, name, height, deleted, created) VALUES (:id, :name, :height, :deleted, :created)"
  self.conn.executemany(query, data)
  ```
- Удаление:
  ```python
  db.delete('user', "name = 'Kirill'")
  ```
- Обновление:
  ```python
  db.update('user', "height = 1.82", "name = 'Oleg'")
  ```

#### 5. Закрытие соединения с БД:
Выполняется вызовом метода `close`.

---

### Вывод:
В результате выполнения лабораторной работы:
- Реализована работа с SQLite через ООП.
- Использован паттерн Singleton для предотвращения множественного подключения к БД.  
- Обеспечена безопасность данных через параметризованные запросы.  
- Класс `User` демонстрирует грамотное использование свойств для контроля значений атрибутов.  